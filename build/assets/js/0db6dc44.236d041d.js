"use strict";(self.webpackChunknada=self.webpackChunknada||[]).push([[254],{3905:function(e,t,r){r.d(t,{Zo:function(){return p},kt:function(){return m}});var n=r(7294);function a(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}function i(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function l(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?i(Object(r),!0).forEach((function(t){a(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):i(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function o(e,t){if(null==e)return{};var r,n,a=function(e,t){if(null==e)return{};var r,n,a={},i=Object.keys(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||(a[r]=e[r]);return a}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)r=i[n],t.indexOf(r)>=0||Object.prototype.propertyIsEnumerable.call(e,r)&&(a[r]=e[r])}return a}var u=n.createContext({}),s=function(e){var t=n.useContext(u),r=t;return e&&(r="function"==typeof e?e(t):l(l({},t),e)),r},p=function(e){var t=s(e.components);return n.createElement(u.Provider,{value:t},e.children)},d={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},k=n.forwardRef((function(e,t){var r=e.components,a=e.mdxType,i=e.originalType,u=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),k=s(r),m=a,c=k["".concat(u,".").concat(m)]||k[m]||d[m]||i;return r?n.createElement(c,l(l({ref:t},p),{},{components:r})):n.createElement(c,l({ref:t},p))}));function m(e,t){var r=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var i=r.length,l=new Array(i);l[0]=k;var o={};for(var u in t)hasOwnProperty.call(t,u)&&(o[u]=t[u]);o.originalType=e,o.mdxType="string"==typeof e?e:a,l[1]=o;for(var s=2;s<i;s++)l[s]=r[s];return n.createElement.apply(null,l)}return n.createElement.apply(null,r)}k.displayName="MDXCreateElement"},3970:function(e,t,r){r.r(t),r.d(t,{frontMatter:function(){return o},contentTitle:function(){return u},metadata:function(){return s},toc:function(){return p},default:function(){return k}});var n=r(7462),a=r(3366),i=(r(7294),r(3905)),l=["components"],o={title:"Jupyterhub"},u=void 0,s={unversionedId:"prosessere-data/onprem/jupyterhub",id:"prosessere-data/onprem/jupyterhub",isDocsHomePage:!1,title:"Jupyterhub",description:"For analyser s\xe5 anbefaler Dataplattform at man bruker Jupyter notebooks.",source:"@site/docs/prosessere-data/onprem/jupyterhub.md",sourceDirName:"prosessere-data/onprem",slug:"/prosessere-data/onprem/jupyterhub",permalink:"/prosessere-data/onprem/jupyterhub",editUrl:"https://github.com/navikt/nada/edit/master/docs/prosessere-data/onprem/jupyterhub.md",tags:[],version:"current",frontMatter:{title:"Jupyterhub"},sidebar:"docs",previous:{title:"Sletting av datapakker",permalink:"/prosessere-data/onprem/dataverk/slette-datapakker"},next:{title:"Vault",permalink:"/prosessere-data/onprem/vault"}},p=[{value:"Konfigurasjon",id:"konfigurasjon",children:[{value:"Namespace",id:"namespace",children:[]},{value:"Ingress",id:"ingress",children:[]},{value:"Users",id:"users",children:[]},{value:"Egne milj\xf8variabler",id:"egne-milj\xf8variabler",children:[]},{value:"Jupyter i stedet for JupyterLabs",id:"jupyter-i-stedet-for-jupyterlabs",children:[]},{value:"Endre ressurser",id:"endre-ressurser",children:[]}]},{value:"Restarte jupyterhub server",id:"restarte-jupyterhub-server",children:[]},{value:"Slette en hub",id:"slette-en-hub",children:[]},{value:"Fjerne brukere",id:"fjerne-brukere",children:[]},{value:"Remote Jupyterhub tilkoblingen",id:"remote-jupyterhub-tilkoblingen",children:[{value:"Lag Jupyterhub API token",id:"lag-jupyterhub-api-token",children:[]},{value:"Koble til fra Visual Studio Code",id:"koble-til-fra-visual-studio-code",children:[]}]}],d={toc:p};function k(e){var t=e.components,o=(0,a.Z)(e,l);return(0,i.kt)("wrapper",(0,n.Z)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,i.kt)("p",null,"For analyser s\xe5 anbefaler Dataplattform at man bruker ",(0,i.kt)("a",{parentName:"p",href:"https://jupyter.org/"},"Jupyter notebooks"),"."),(0,i.kt)("p",null,"Din JupyterHub blir lagd basert p\xe5 en konfigurasjon i ",(0,i.kt)("a",{parentName:"p",href:"https://github.com/navikt/knada-jupyterhub"},"navikt/knada-jupyterhub"),"-repoet.\nI repoet kan du legge til din egen konfigurasjon i ",(0,i.kt)("inlineCode",{parentName:"p"},"/configs")," katalogen. "),(0,i.kt)("p",null,"For \xe5 kunne sette opp en ny hub m\xe5 man lage en Pull Request til dette repoet.\nDa vil man ogs\xe5 f\xe5 generert en kryptert n\xf8kkel som brukes av JupyterHub internt.\nDerfor er det viktig at man har linjeskift p\xe5 slutten av konfigurasjonen."),(0,i.kt)("p",null,"Ved hver ny pull request (og endringer) blir sjekker kj\xf8rt automatisk.\nN\xe5r disse sjekkene er godkjente (lyser gr\xf8nt), kan du selv merge inn din pull request.\nDu trenger alts\xe5 ",(0,i.kt)("em",{parentName:"p"},"ikke")," vente p\xe5 godkjenning."),(0,i.kt)("p",null,"Nedenfor ser du et eksempel p\xe5 det man minimum trenger \xe5 fylle ut.\nMed denne konfigurasjonen f\xe5r man en hub med 2GB minne, og 0.5 CPU.\nHub-en kan n\xe5es p\xe5 ",(0,i.kt)("inlineCode",{parentName:"p"},"https://kyrre.jupyter.adeo.no")," og det er kun bruker ",(0,i.kt)("inlineCode",{parentName:"p"},"e152435")," som kan logge inn."),(0,i.kt)("p",null,(0,i.kt)("inlineCode",{parentName:"p"},"/configs/kyrre.yaml")),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"namespace: kyrre-havik-eriksen\ningress: kyrre\nusers:\n  - e152435\n")),(0,i.kt)("p",null,"Alle verdier kan endres etter behov."),(0,i.kt)("h2",{id:"konfigurasjon"},"Konfigurasjon"),(0,i.kt)("h3",{id:"namespace"},"Namespace"),(0,i.kt)("p",null,"Hvilket ",(0,i.kt)("inlineCode",{parentName:"p"},"namespace")," hub-en skal kj\xf8re i.\nEndrer du denne vil det bli opprettet en ny hub, og den gamle vil fortsatt leve.\nSe ",(0,i.kt)("a",{parentName:"p",href:"#slette-en-hub"},"Slette en hub")," nedenfor hvis du bytter namespace."),(0,i.kt)("h3",{id:"ingress"},"Ingress"),(0,i.kt)("p",null,"Hvilken adresse du kan n\xe5 hub-en p\xe5.\nDet du setter i ",(0,i.kt)("inlineCode",{parentName:"p"},"ingress")," blir sl\xe5tt sammen med ",(0,i.kt)("inlineCode",{parentName:"p"},".jupyter.adeo.no"),"."),(0,i.kt)("h3",{id:"users"},"Users"),(0,i.kt)("p",null,"Dette er en liste over hvem som skal ha tilgang til \xe5 kunne logge inn p\xe5 hub-en.\nHer bruker vi NAV-identen (med sm\xe5 bokstaver)."),(0,i.kt)("h3",{id:"egne-milj\xf8variabler"},"Egne milj\xf8variabler"),(0,i.kt)("p",null,"Har du behov for egne milj\xf8variabler, kan de legges under ",(0,i.kt)("inlineCode",{parentName:"p"},"extraEnvs")," i konfigurasjonen din:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},'extraEnvs:\n  - "hello: world"\n')),(0,i.kt)("p",null,"Hver linje m\xe5 starte med ",(0,i.kt)("inlineCode",{parentName:"p"},"-"),"/bindestrek, og v\xe6re innen for anf\xf8rselstegn.\nDette fordi den blir tolket som en ren streng, og ikke som en n\xf8kkel og verdi."),(0,i.kt)("h3",{id:"jupyter-i-stedet-for-jupyterlabs"},"Jupyter i stedet for JupyterLabs"),(0,i.kt)("p",null,"Om du \xf8nsker \xe5 bruke Jupyter i stedet for JupyterLabs kan du legge til f\xf8lgende i konfigurasjonen din:"),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"jupyterLabs: false\n")),(0,i.kt)("h3",{id:"endre-ressurser"},"Endre ressurser"),(0,i.kt)("p",null,"Har du behov for mer/mindre ressurser enn det som er default, kan du bruke variablene ",(0,i.kt)("inlineCode",{parentName:"p"},"memoryLimit")," og ",(0,i.kt)("inlineCode",{parentName:"p"},"cpuLimit")," i din konfigurasjon."),(0,i.kt)("pre",null,(0,i.kt)("code",{parentName:"pre"},"memoryLimit: 10GB\ncpuLimit: 1\n")),(0,i.kt)("p",null,"Hvis jupyterhub serveren du endrer ressurskonfigurasjonen for kj\xf8rer n\xe5r du endrer ",(0,i.kt)("inlineCode",{parentName:"p"},"memoryLimit"),"/",(0,i.kt)("inlineCode",{parentName:"p"},"cpuLimit")," m\xe5 du restarte serveren\nfor at endringene skal tre i kraft. For \xe5 restarte serveren se ",(0,i.kt)("a",{parentName:"p",href:"#restarte-jupyterhub-server"},"Restarte jupyterhub server")),(0,i.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,i.kt)("div",{parentName:"div",className:"admonition-heading"},(0,i.kt)("h5",{parentName:"div"},(0,i.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,i.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,i.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"info")),(0,i.kt)("div",{parentName:"div",className:"admonition-content"},(0,i.kt)("p",{parentName:"div"},"Jupyterhub f\xf8lger strengt med p\xe5 hvor mye ressurser du bruker, og vil drepe kernel hvis du bruker mer enn du har bedt om."))),(0,i.kt)("h2",{id:"restarte-jupyterhub-server"},"Restarte jupyterhub server"),(0,i.kt)("p",null,"For \xe5 restarte serveren gj\xf8res f\xf8lgende:"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"G\xe5 til ",(0,i.kt)("inlineCode",{parentName:"li"},"https://<ingress>.jupyter.adeo.no/home")),(0,i.kt)("li",{parentName:"ol"},"Trykk ",(0,i.kt)("inlineCode",{parentName:"li"},"Stop My Server")),(0,i.kt)("li",{parentName:"ol"},"N\xe5r du igjen f\xe5r muligheten til \xe5 starte serveren trykker du ",(0,i.kt)("inlineCode",{parentName:"li"},"Start My Server"))),(0,i.kt)("h2",{id:"slette-en-hub"},"Slette en hub"),(0,i.kt)("p",null,"Vi har ingen automatikk for sletting av hub-er, s\xe5 dette m\xe5 gj\xf8res manuelt av en av administratorene.\nTa kontakt i ",(0,i.kt)("a",{parentName:"p",href:"https://nav-it.slack.com/archives/CGRMQHT50"},"#knada"),"."),(0,i.kt)("h2",{id:"fjerne-brukere"},"Fjerne brukere"),(0,i.kt)("p",null,"For \xe5 fjerne brukere fra et jupyterhub namespace gj\xf8r som f\xf8lger:"),(0,i.kt)("ul",null,(0,i.kt)("li",{parentName:"ul"},"Fjern identen(e) fra ",(0,i.kt)("inlineCode",{parentName:"li"},"users")," listen i konfigurasjonsfilen under ",(0,i.kt)("inlineCode",{parentName:"li"},"/config")," i ",(0,i.kt)("a",{parentName:"li",href:"https://github.com/navikt/knada-jupyterhub"},"iac-repoet")),(0,i.kt)("li",{parentName:"ul"},"Logg inn p\xe5 hubens admin side (",(0,i.kt)("inlineCode",{parentName:"li"},"https://<ingress>.jupyter.adeo.no/hub/admin"),") og slett brukeren(e) fra databasen.")),(0,i.kt)("h2",{id:"remote-jupyterhub-tilkoblingen"},"Remote Jupyterhub tilkoblingen"),(0,i.kt)("p",null,"\xd8nsker du \xe5 koble til remote Jupyterhub fra Visual Studio Code lokalt, gj\xf8r som f\xf8lger:"),(0,i.kt)("h3",{id:"lag-jupyterhub-api-token"},"Lag Jupyterhub API token"),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"G\xe5 til ",(0,i.kt)("inlineCode",{parentName:"li"},"https://<ingress>.jupyter.adeo.no/home")),(0,i.kt)("li",{parentName:"ol"},"Trykk ",(0,i.kt)("inlineCode",{parentName:"li"},"token")," \xf8verst til venstre"),(0,i.kt)("li",{parentName:"ol"},"Trykk ",(0,i.kt)("inlineCode",{parentName:"li"},"Request new API token")),(0,i.kt)("li",{parentName:"ol"},"Lagre det genererte tokenet lokalt")),(0,i.kt)("h3",{id:"koble-til-fra-visual-studio-code"},"Koble til fra Visual Studio Code"),(0,i.kt)("p",null,"N\xe5r du har laget et API token kan du koble deg til Jupyterhub serveren."),(0,i.kt)("ol",null,(0,i.kt)("li",{parentName:"ol"},"Installer Jupyter extension for Visual Studio Code\n",(0,i.kt)("img",{alt:"Jupyter extension",src:r(4225).Z})),(0,i.kt)("li",{parentName:"ol"},"Trykk ",(0,i.kt)("inlineCode",{parentName:"li"},"cntrl+shift+P")," (windows) eller ",(0,i.kt)("inlineCode",{parentName:"li"},"cmd+shift+P")," (mac)"),(0,i.kt)("li",{parentName:"ol"},"S\xf8k etter ",(0,i.kt)("inlineCode",{parentName:"li"},"Jupyter: Specify local or remote Jupyter server for connections")),(0,i.kt)("li",{parentName:"ol"},"Velg ",(0,i.kt)("inlineCode",{parentName:"li"},"Existing")),(0,i.kt)("li",{parentName:"ol"},"Skriv inn URIen til den kj\xf8rende jupytehrub serveren,\ndvs. ",(0,i.kt)("inlineCode",{parentName:"li"},"https://<ingress>.jupyter.adeo.no/user/<nav-ident>/?token=<token>"),". Erstatt ingress og NAV ident, og token med\ntokenet generert i ",(0,i.kt)("a",{parentName:"li",href:"#create-jupyterhub-api-token"},"Create Jupyterhub API token")),(0,i.kt)("li",{parentName:"ol"},"Logg inn med NAV ident og passord")))}k.isMDXComponent=!0},4225:function(e,t,r){t.Z=r.p+"assets/images/jupyter-extension-5cd9536ffd3bad3424ef875b5c8171ac.png"}}]);